<!DOCTYPE html>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Fallback to default mdbook template -->
        
        <meta name="robots" content="noindex,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta charset="utf-8">
        <title>Modules - LuaNext Documentation</title>
        <script>
            var theme = localStorage.getItem("mdbook-theme");
            if (theme === null || theme === undefined) { theme = "light"; }
            var html = document.querySelector("html");
            html.classList.remove("light");
            html.classList.add(theme);
        </script>
        <meta name="description" content="A typed superset of Lua with gradual typing, inspired by TypeScript">
        <link rel="icon" href="favicon.svg">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/custom.css">
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">

    </head>
    <body>
        <!-- Provide the book title to JavaScript -->
        <script>
            window.book = window.book || {};
            window.book.language = "en";
        </script>

        <div id="book" class="book">
            <div class="book-inner">

            <nav role="navigation" aria-label="Table of contents" class="sidebar">
                <ol class="chapter"><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="introduction.html">Introduction</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Language</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/basics.html"><strong aria-hidden="true">1.</strong> Basics</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/control-flow.html"><strong aria-hidden="true">2.</strong> Control Flow</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/functions.html"><strong aria-hidden="true">3.</strong> Functions</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/type-system.html"><strong aria-hidden="true">4.</strong> Type System</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/classes.html"><strong aria-hidden="true">5.</strong> Classes</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/interfaces.html"><strong aria-hidden="true">6.</strong> Interfaces</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/enums.html"><strong aria-hidden="true">7.</strong> Enums</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/modules.html"><strong aria-hidden="true">8.</strong> Modules</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/error-handling.html"><strong aria-hidden="true">9.</strong> Error Handling</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/pattern-matching.html"><strong aria-hidden="true">10.</strong> Pattern Matching</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/decorators.html"><strong aria-hidden="true">11.</strong> Decorators</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/advanced-types.html"><strong aria-hidden="true">12.</strong> Advanced Types</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/operators.html"><strong aria-hidden="true">13.</strong> Operators</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Guides</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="guides/migrating-from-lua.html"><strong aria-hidden="true">14.</strong> Migrating from Lua</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="guides/lua-targets.html"><strong aria-hidden="true">15.</strong> Lua Targets</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Reference</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/cli.html"><strong aria-hidden="true">16.</strong> CLI</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/configuration.html"><strong aria-hidden="true">17.</strong> Configuration</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/standard-library.html"><strong aria-hidden="true">18.</strong> Standard Library</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/utility-types.html"><strong aria-hidden="true">19.</strong> Utility Types</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/reflection.html"><strong aria-hidden="true">20.</strong> Reflection API</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/error-codes.html"><strong aria-hidden="true">21.</strong> Error Codes</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/grammar.html"><strong aria-hidden="true">22.</strong> Grammar</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/keywords.html"><strong aria-hidden="true">23.</strong> Keywords</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Contributing</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="contributing/setup.html"><strong aria-hidden="true">24.</strong> Getting Started</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">API Reference</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="api/index.html"><strong aria-hidden="true">25.</strong> Rust API Docs</a></span></li></ol>
            </nav>

            <div id="page-wrapper" class="page-wrapper">

                <div class="page-inner">

                <section class="normal" id="main">
                    <h1 id="modules"><a class="header" href="#modules">Modules</a></h1>
<p>LuaNext provides a modern module system with ES6-style imports and exports. Each file is a module, and you can import/export values, types, and declarations between files.</p>
<h2 id="syntax"><a class="header" href="#syntax">Syntax</a></h2>
<h3 id="imports"><a class="header" href="#imports">Imports</a></h3>
<pre><code class="language-lua">-- Default import
import defaultExport from "./module"

-- Named imports
import {export1, export2} from "./module"

-- Renamed imports
import {export1 as alias1, export2 as alias2} from "./module"

-- Namespace import
import * as name from "./module"

-- Type-only imports
import type {Type1, Type2} from "./module"

-- Mixed import
import defaultExport, {named1, named2} from "./module"
</code></pre>
<h3 id="exports"><a class="header" href="#exports">Exports</a></h3>
<pre><code class="language-lua">-- Export declaration
export const x: number = 42
export function greet(name: string): string
    return "Hello, " .. name
end
export class User
    -- ...
end

-- Named exports
const x = 10
const y = 20
export {x, y}

-- Renamed exports
export {x as publicX, y as publicY}

-- Default export
export default function main(): void
    print("Main function")
end

-- Re-exports
export {foo, bar} from "./other"
export * from "./other"
</code></pre>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<h3 id="basic-module"><a class="header" href="#basic-module">Basic Module</a></h3>
<p><strong>math.luax:</strong></p>
<pre><code class="language-lua">export function add(a: number, b: number): number
    return a + b
end

export function subtract(a: number, b: number): number
    return a - b
end

export const PI: number = 3.14159
</code></pre>
<p><strong>main.luax:</strong></p>
<pre><code class="language-lua">import {add, subtract, PI} from "./math"

print(add(5, 3))        -- 8
print(subtract(10, 4))  -- 6
print(PI)               -- 3.14159
</code></pre>
<p>Compiles to:</p>
<p><strong>math.lua:</strong></p>
<pre><code class="language-lua">local M = {}

function M.add(a, b)
    return a + b
end

function M.subtract(a, b)
    return a - b
end

M.PI = 3.14159

return M
</code></pre>
<p><strong>main.lua:</strong></p>
<pre><code class="language-lua">local math = require("./math")

print(math.add(5, 3))
print(math.subtract(10, 4))
print(math.PI)
</code></pre>
<h3 id="default-export"><a class="header" href="#default-export">Default Export</a></h3>
<p><strong>logger.luax:</strong></p>
<pre><code class="language-lua">class Logger
    function log(message: string): void
        print("[LOG] " .. message)
    end

    function error(message: string): void
        print("[ERROR] " .. message)
    end
end

export default Logger
</code></pre>
<p><strong>main.luax:</strong></p>
<pre><code class="language-lua">import Logger from "./logger"

const logger = Logger.new()
logger:log("Application started")
</code></pre>
<h3 id="named-exports"><a class="header" href="#named-exports">Named Exports</a></h3>
<p><strong>config.luax:</strong></p>
<pre><code class="language-lua">export const API_URL: string = "https://api.example.com"
export const TIMEOUT: number = 5000
export const MAX_RETRIES: number = 3

export function getConfig(): {url: string, timeout: number}
    return {
        url = API_URL,
        timeout = TIMEOUT
    }
end
</code></pre>
<p><strong>main.luax:</strong></p>
<pre><code class="language-lua">import {API_URL, TIMEOUT, getConfig} from "./config"

print(API_URL)     -- https://api.example.com
print(TIMEOUT)     -- 5000

const config = getConfig()
</code></pre>
<h3 id="renamed-imports"><a class="header" href="#renamed-imports">Renamed Imports</a></h3>
<pre><code class="language-lua">import {add as sum, subtract as diff} from "./math"

print(sum(5, 3))   -- 8
print(diff(10, 4)) -- 6
</code></pre>
<h3 id="namespace-import"><a class="header" href="#namespace-import">Namespace Import</a></h3>
<p>Import all exports under a single namespace:</p>
<pre><code class="language-lua">import * as math from "./math"

print(math.add(5, 3))
print(math.subtract(10, 4))
print(math.PI)
</code></pre>
<h3 id="type-only-imports"><a class="header" href="#type-only-imports">Type-Only Imports</a></h3>
<p>Import only types (no runtime code generated):</p>
<p><strong>types.luax:</strong></p>
<pre><code class="language-lua">export interface User
    id: string
    name: string
    email: string
end

export type Status = "active" | "inactive"

export const DEFAULT_STATUS: Status = "active"
</code></pre>
<p><strong>main.luax:</strong></p>
<pre><code class="language-lua">import type {User, Status} from "./types"
import {DEFAULT_STATUS} from "./types"

const user: User = {
    id = "user-123",
    name = "Alice",
    email = "alice@example.com"
}

const status: Status = DEFAULT_STATUS
</code></pre>
<p>Compiles to (type imports are erased):</p>
<pre><code class="language-lua">local types = require("./types")

local user = {
    id = "user-123",
    name = "Alice",
    email = "alice@example.com"
}

local status = types.DEFAULT_STATUS
</code></pre>
<h3 id="mixed-imports"><a class="header" href="#mixed-imports">Mixed Imports</a></h3>
<p>Combine default and named imports:</p>
<p><strong>utils.luax:</strong></p>
<pre><code class="language-lua">export function helper1(): void
    print("Helper 1")
end

export function helper2(): void
    print("Helper 2")
end

export default function main(): void
    print("Main utility")
end
</code></pre>
<p><strong>main.luax:</strong></p>
<pre><code class="language-lua">import mainUtil, {helper1, helper2} from "./utils"

mainUtil()    -- Main utility
helper1()     -- Helper 1
helper2()     -- Helper 2
</code></pre>
<h3 id="re-exports"><a class="header" href="#re-exports">Re-Exports</a></h3>
<p>Re-export from another module:</p>
<p><strong>api/users.luax:</strong></p>
<pre><code class="language-lua">export function getUser(id: string): User
    -- ...
end

export function createUser(data: UserData): User
    -- ...
end
</code></pre>
<p><strong>api/posts.luax:</strong></p>
<pre><code class="language-lua">export function getPost(id: string): Post
    -- ...
end
</code></pre>
<p><strong>api/index.luax:</strong></p>
<pre><code class="language-lua">-- Re-export everything from users and posts
export * from "./users"
export * from "./posts"

-- Or re-export specific items
export {getUser, createUser} from "./users"
export {getPost} from "./posts"
</code></pre>
<p><strong>main.luax:</strong></p>
<pre><code class="language-lua">import {getUser, getPost} from "./api"

const user = getUser("user-123")
const post = getPost("post-456")
</code></pre>
<h3 id="exporting-types"><a class="header" href="#exporting-types">Exporting Types</a></h3>
<p>Export type declarations:</p>
<p><strong>types.luax:</strong></p>
<pre><code class="language-lua">export interface Point
    x: number
    y: number
end

export type Vector = Point

export type Result&lt;T&gt; = {success: true, value: T} | {success: false, error: string}
</code></pre>
<p><strong>main.luax:</strong></p>
<pre><code class="language-lua">import type {Point, Vector, Result} from "./types"

const p: Point = {x = 1, y = 2}
const v: Vector = {x = 3, y = 4}
const result: Result&lt;number&gt; = {success = true, value = 42}
</code></pre>
<h3 id="file-namespaces"><a class="header" href="#file-namespaces">File Namespaces</a></h3>
<p>Declare a namespace for the entire file:</p>
<p><strong>math.luax:</strong></p>
<pre><code class="language-lua">namespace Math

export function add(a: number, b: number): number
    return a + b
end

export function subtract(a: number, b: number): number
    return a - b
end

export const PI: number = 3.14159
</code></pre>
<p><strong>main.luax:</strong></p>
<pre><code class="language-lua">import {add, PI} from "./math"

-- Or use namespace import
import * as Math from "./math"

print(Math.add(5, 3))
print(Math.PI)
</code></pre>
<h3 id="circular-dependencies"><a class="header" href="#circular-dependencies">Circular Dependencies</a></h3>
<p>LuaNext detects circular dependencies at compile time:</p>
<p><strong>a.luax:</strong></p>
<pre><code class="language-lua">import {foo} from "./b"

export function bar(): void
    print("bar")
    foo()
end
</code></pre>
<p><strong>b.luax:</strong></p>
<pre><code class="language-lua">import {bar} from "./a"

export function foo(): void
    print("foo")
    bar()
end
</code></pre>
<pre><code>Error: Circular dependency detected:
  a.luax -&gt; b.luax -&gt; a.luax
</code></pre>
<h4 id="breaking-circular-dependencies-with-type-only-imports"><a class="header" href="#breaking-circular-dependencies-with-type-only-imports">Breaking Circular Dependencies with Type-Only Imports</a></h4>
<p>Type-only imports don’t create runtime dependencies:</p>
<p><strong>a.luax:</strong></p>
<pre><code class="language-lua">import type {BType} from "./b"
import {bFunction} from "./b"

export interface AType
    value: number
end

export function aFunction(b: BType): void
    print(b.name)
end
</code></pre>
<p><strong>b.luax:</strong></p>
<pre><code class="language-lua">import type {AType} from "./a"  -- Type-only, no circular dependency

export interface BType
    name: string
end

export function bFunction(a: AType): void
    print(a.value)
end
</code></pre>
<p>This works because type-only imports are erased at runtime.</p>
<h2 id="details"><a class="header" href="#details">Details</a></h2>
<h3 id="module-resolution"><a class="header" href="#module-resolution">Module Resolution</a></h3>
<p>LuaNext resolves modules using the following rules:</p>
<ol>
<li>
<p><strong>Relative paths</strong> — Start with <code>./</code> or <code>../</code></p>
<ul>
<li><code>./module</code> → same directory</li>
<li><code>../module</code> → parent directory</li>
<li><code>../../module</code> → grandparent directory</li>
</ul>
</li>
<li>
<p><strong>Absolute paths</strong> — Resolved from project root or node_modules</p>
</li>
<li>
<p><strong>File extensions</strong> — <code>.luax</code> is implicit</p>
<ul>
<li><code>import {x} from "./module"</code> → looks for <code>module.luax</code></li>
</ul>
</li>
</ol>
<h3 id="export-restrictions"><a class="header" href="#export-restrictions">Export Restrictions</a></h3>
<ul>
<li>Each file can have at most one default export</li>
<li>Cannot export the same name twice</li>
<li>Cannot re-export and locally export the same name</li>
</ul>
<pre><code class="language-lua">-- Error: Duplicate export
export const x = 1
export const x = 2  -- ❌ Error

-- Error: Duplicate default export
export default function foo() end
export default function bar() end  -- ❌ Error
</code></pre>
<h3 id="import-restrictions"><a class="header" href="#import-restrictions">Import Restrictions</a></h3>
<ul>
<li>Cannot import from a module that doesn’t export the name</li>
<li>Cannot import the same name twice in one import statement</li>
</ul>
<pre><code class="language-lua">-- Error: Module doesn't export 'unknownExport'
import {unknownExport} from "./module"  -- ❌ Error

-- Error: Duplicate import
import {x, x} from "./module"  -- ❌ Error
</code></pre>
<h3 id="type-only-imports-1"><a class="header" href="#type-only-imports-1">Type-Only Imports</a></h3>
<p>Type-only imports:</p>
<ul>
<li>Import types, interfaces, and type aliases</li>
<li>Generate no runtime code</li>
<li>Help break circular dependencies</li>
<li>Clearly separate type and value imports</li>
</ul>
<pre><code class="language-lua">-- Type-only: no require() generated
import type {User} from "./types"

-- Regular import: generates require()
import {createUser} from "./api"
</code></pre>
<h3 id="export-all"><a class="header" href="#export-all">Export All</a></h3>
<p><code>export * from "./module"</code> re-exports everything except:</p>
<ul>
<li>Default exports (must be explicitly re-exported)</li>
<li>Type-only exports (unless using <code>export type * from</code>)</li>
</ul>
<pre><code class="language-lua">-- Re-export all values
export * from "./module"

-- Re-export all types
export type * from "./types"

-- Re-export specific default
export {default as MyDefault} from "./module"
</code></pre>
<h3 id="module-compilation-modes"><a class="header" href="#module-compilation-modes">Module Compilation Modes</a></h3>
<p>LuaNext supports two module compilation modes:</p>
<p><strong>1. Require Mode (default)</strong></p>
<p>Each module compiles to a file with <code>return M</code>:</p>
<pre><code class="language-lua">local M = {}
M.foo = ...
return M
</code></pre>
<p>Imported with <code>require()</code>:</p>
<pre><code class="language-lua">local module = require("./module")
</code></pre>
<p><strong>2. Bundle Mode</strong></p>
<p>All modules bundled into a single file with inline module definitions.</p>
<p>Configure in <code>luanext.config.yaml</code>:</p>
<pre><code class="language-yaml">module:
  mode: "require"  # or "bundle"
</code></pre>
<h3 id="module-scope"><a class="header" href="#module-scope">Module Scope</a></h3>
<p>Each module has its own scope:</p>
<ul>
<li>Top-level variables are local to the module</li>
<li>Only exported values are accessible from other modules</li>
<li>Imports are available throughout the module</li>
</ul>
<pre><code class="language-lua">-- Private to this module
const PRIVATE_CONSTANT = 42

function privateHelper(): void
    -- Only accessible within this file
end

-- Public (exported)
export function publicAPI(): void
    privateHelper()  -- Can use private functions
end
</code></pre>
<h3 id="module-initialization"><a class="header" href="#module-initialization">Module Initialization</a></h3>
<p>Modules are initialized once on first import:</p>
<p><strong>counter.luax:</strong></p>
<pre><code class="language-lua">print("Initializing counter module")

const count = 0

export function increment(): void
    count = count + 1
end

export function getCount(): number
    return count
end
</code></pre>
<p><strong>main.luax:</strong></p>
<pre><code class="language-lua">import {increment, getCount} from "./counter"  -- Prints "Initializing counter module"
import {increment as inc} from "./counter"     -- Does NOT print again

increment()
print(getCount())  -- 1
inc()
print(getCount())  -- 2
</code></pre>
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><a href="basics.html">Basics</a> — Variable declarations and types</li>
<li><a href="classes.html">Classes</a> — Exporting classes</li>
<li><a href="interfaces.html">Interfaces</a> — Exporting type definitions</li>
<li><a href="../reference/configuration.html#namespaces">Namespaces</a> — File namespaces</li>
</ul>

                </section>

                </div><!-- page-inner -->

            </div><!-- page-wrapper -->

            </div><!-- book-inner -->

            <!-- Version Selector -->
            <nav class="nav-wide-wrapper" aria-label="More">
                <a href="javascript:void(0)" id="menu-bar-wide" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                    <i class="fa fa-bars"></i>
                </a>
            </nav>

            <!-- Version selector dropdown -->
            <div id="version-selector" class="version-selector">
                <select id="version-picker" onchange="switchVersion(this.value)" aria-label="Documentation version">
                    <option value="latest">Latest</option>
                </select>
            </div>

        </div><!-- book -->

        <!-- Custom scripts -->
        <script>
            // Version selector functionality
            function switchVersion(version) {
                const base = window.location.origin + '/luanext/';
                if (version === 'latest') {
                    window.location.href = base;
                } else {
                    window.location.href = base + version + '/';
                }
            }

            // Load versions.json and populate selector if it exists
            fetch('/luanext/versions.json')
                .then(response => response.json())
                .then(data => {
                    if (data.versions && data.versions.length > 1) {
                        const selector = document.getElementById('version-picker');
                        data.versions.forEach(v => {
                            if (v.version !== 'latest') {
                                const option = document.createElement('option');
                                option.value = 'v' + v.version;
                                option.textContent = 'v' + v.version;
                                selector.appendChild(option);
                            }
                        });
                    }
                })
                .catch(() => {
                    // versions.json not found (expected during initial setup)
                    // Selector will only show "Latest"
                });
        </script>

        <!-- mdBook scripts and content scripts -->
        <script src="js/clipboard.min.js" type="text/javascript"></script>
        <script src="js/highlight.js" type="text/javascript"></script>
        <script src="js/book.js" type="text/javascript"></script>

        <!-- Custom theme script -->
        <script src="js/custom-theme.js" type="text/javascript"></script>

        <script src="js/elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/lunr-en.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/search.js" type="text/javascript" charset="utf-8"></script>

    </body>
</html>
