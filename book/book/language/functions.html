<!DOCTYPE html>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Fallback to default mdbook template -->
        
        <meta name="robots" content="noindex,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta charset="utf-8">
        <title>Functions - LuaNext Documentation</title>
        <script>
            var theme = localStorage.getItem("mdbook-theme");
            if (theme === null || theme === undefined) { theme = "light"; }
            var html = document.querySelector("html");
            html.classList.remove("light");
            html.classList.add(theme);
        </script>
        <meta name="description" content="A typed superset of Lua with gradual typing, inspired by TypeScript">
        <link rel="icon" href="favicon.svg">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/custom.css">
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">

    </head>
    <body>
        <!-- Provide the book title to JavaScript -->
        <script>
            window.book = window.book || {};
            window.book.language = "en";
        </script>

        <div id="book" class="book">
            <div class="book-inner">

            <nav role="navigation" aria-label="Table of contents" class="sidebar">
                <ol class="chapter"><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="introduction.html">Introduction</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Language</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/basics.html"><strong aria-hidden="true">1.</strong> Basics</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/control-flow.html"><strong aria-hidden="true">2.</strong> Control Flow</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/functions.html"><strong aria-hidden="true">3.</strong> Functions</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/type-system.html"><strong aria-hidden="true">4.</strong> Type System</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/classes.html"><strong aria-hidden="true">5.</strong> Classes</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/interfaces.html"><strong aria-hidden="true">6.</strong> Interfaces</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/enums.html"><strong aria-hidden="true">7.</strong> Enums</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/modules.html"><strong aria-hidden="true">8.</strong> Modules</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/error-handling.html"><strong aria-hidden="true">9.</strong> Error Handling</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/pattern-matching.html"><strong aria-hidden="true">10.</strong> Pattern Matching</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/decorators.html"><strong aria-hidden="true">11.</strong> Decorators</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/advanced-types.html"><strong aria-hidden="true">12.</strong> Advanced Types</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/operators.html"><strong aria-hidden="true">13.</strong> Operators</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Guides</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="guides/migrating-from-lua.html"><strong aria-hidden="true">14.</strong> Migrating from Lua</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="guides/lua-targets.html"><strong aria-hidden="true">15.</strong> Lua Targets</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Reference</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/cli.html"><strong aria-hidden="true">16.</strong> CLI</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/configuration.html"><strong aria-hidden="true">17.</strong> Configuration</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/standard-library.html"><strong aria-hidden="true">18.</strong> Standard Library</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/utility-types.html"><strong aria-hidden="true">19.</strong> Utility Types</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/reflection.html"><strong aria-hidden="true">20.</strong> Reflection API</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/error-codes.html"><strong aria-hidden="true">21.</strong> Error Codes</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/grammar.html"><strong aria-hidden="true">22.</strong> Grammar</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/keywords.html"><strong aria-hidden="true">23.</strong> Keywords</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Contributing</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="contributing/setup.html"><strong aria-hidden="true">24.</strong> Getting Started</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">API Reference</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="api/index.html"><strong aria-hidden="true">25.</strong> Rust API Docs</a></span></li></ol>
            </nav>

            <div id="page-wrapper" class="page-wrapper">

                <div class="page-inner">

                <section class="normal" id="main">
                    <h1 id="functions"><a class="header" href="#functions">Functions</a></h1>
<p>Functions in LuaNext support type annotations, generics, default parameters, rest parameters, and more.</p>
<h2 id="function-declarations"><a class="header" href="#function-declarations">Function Declarations</a></h2>
<h3 id="basic-function"><a class="header" href="#basic-function">Basic Function</a></h3>
<pre><code class="language-lua">function greet(name: string): string
    return "Hello, " .. name
end

const message: string = greet("Alice")
</code></pre>
<p>Compiles to:</p>
<pre><code class="language-lua">local function greet(name)
    return "Hello, " .. name
end

local message = greet("Alice")
</code></pre>
<h3 id="without-return-type"><a class="header" href="#without-return-type">Without Return Type</a></h3>
<p>Return type can be inferred:</p>
<pre><code class="language-lua">function add(a: number, b: number)
    return a + b  -- Return type inferred as number
end
</code></pre>
<h3 id="void-functions"><a class="header" href="#void-functions">Void Functions</a></h3>
<p>Functions that don’t return a value:</p>
<pre><code class="language-lua">function log(message: string): void
    print(message)
end
</code></pre>
<h2 id="arrow-functions"><a class="header" href="#arrow-functions">Arrow Functions</a></h2>
<p>Concise function syntax:</p>
<pre><code class="language-lua">const add = (a: number, b: number): number =&gt; a + b

const greet = (name: string): string =&gt; {
    return "Hello, " .. name
}
</code></pre>
<p>Single-expression arrows don’t need braces or <code>return</code>:</p>
<pre><code class="language-lua">const double = (x: number): number =&gt; x * 2
</code></pre>
<p>Compiles to:</p>
<pre><code class="language-lua">local add = function(a, b)
    return a + b
end

local double = function(x)
    return x * 2
end
</code></pre>
<h2 id="function-parameters"><a class="header" href="#function-parameters">Function Parameters</a></h2>
<h3 id="required-parameters"><a class="header" href="#required-parameters">Required Parameters</a></h3>
<pre><code class="language-lua">function greet(first: string, last: string): string
    return "Hello, " .. first .. " " .. last
end
</code></pre>
<h3 id="optional-parameters"><a class="header" href="#optional-parameters">Optional Parameters</a></h3>
<p>Use <code>?</code> for optional parameters:</p>
<pre><code class="language-lua">function greet(name: string, title?: string): string
    if title then
        return title .. " " .. name
    else
        return name
    end
end

greet("Alice")              -- OK
greet("Alice", "Dr.")       -- OK
</code></pre>
<p>Optional parameters must come after required parameters.</p>
<h3 id="default-parameters"><a class="header" href="#default-parameters">Default Parameters</a></h3>
<p>Provide default values:</p>
<pre><code class="language-lua">function greet(name: string, greeting: string = "Hello"): string
    return greeting .. ", " .. name
end

greet("Alice")              -- "Hello, Alice"
greet("Bob", "Hi")          -- "Hi, Bob"
</code></pre>
<p>Compiles to:</p>
<pre><code class="language-lua">local function greet(name, greeting)
    if greeting == nil then
        greeting = "Hello"
    end
    return greeting .. ", " .. name
end
</code></pre>
<h3 id="rest-parameters"><a class="header" href="#rest-parameters">Rest Parameters</a></h3>
<p>Collect remaining arguments into an array:</p>
<pre><code class="language-lua">function sum(...numbers: number[]): number
    local total: number = 0
    for i, n in ipairs(numbers) do
        total = total + n
    end
    return total
end

sum(1, 2, 3, 4, 5)  -- 15
</code></pre>
<p>Compiles to:</p>
<pre><code class="language-lua">local function sum(...)
    local numbers = {...}
    local total = 0
    for i, n in ipairs(numbers) do
        total = total + n
    end
    return total
end
</code></pre>
<h2 id="multiple-return-values"><a class="header" href="#multiple-return-values">Multiple Return Values</a></h2>
<p>Functions can return multiple values:</p>
<pre><code class="language-lua">function divmod(a: number, b: number): [number, number]
    return math.floor(a / b), a % b
end

const quotient, remainder = divmod(17, 5)  -- 3, 2
</code></pre>
<p>Named return values (documentation only):</p>
<pre><code class="language-lua">function process(data: string): [result: boolean, error: string | nil]
    if data == "" then
        return false, "Empty data"
    end
    return true, nil
end
</code></pre>
<h2 id="generics"><a class="header" href="#generics">Generics</a></h2>
<p>Type-safe generic functions:</p>
<pre><code class="language-lua">function identity&lt;T&gt;(value: T): T
    return value
end

const num: number = identity(42)
const str: string = identity("hello")
</code></pre>
<p>Multiple type parameters:</p>
<pre><code class="language-lua">function pair&lt;T, U&gt;(first: T, second: U): [T, U]
    return first, second
end

const result = pair("Alice", 30)  -- [string, number]
</code></pre>
<h3 id="generic-constraints"><a class="header" href="#generic-constraints">Generic Constraints</a></h3>
<p>Restrict type parameters:</p>
<pre><code class="language-lua">interface HasLength {
    length: number
}

function getLength&lt;T extends HasLength&gt;(value: T): number
    return value.length
end

getLength("hello")      -- OK (string has length)
getLength({1, 2, 3})    -- OK (array has length)
getLength(42)           -- Error: number doesn't have length
</code></pre>
<h3 id="generic-defaults"><a class="header" href="#generic-defaults">Generic Defaults</a></h3>
<p>Provide default types:</p>
<pre><code class="language-lua">function createArray&lt;T = string&gt;(size: number): T[]
    const arr: T[] = {}
    return arr
end

const strings = createArray(10)        -- string[] (default)
const numbers = createArray&lt;number&gt;(5) -- number[]
</code></pre>
<h2 id="function-types"><a class="header" href="#function-types">Function Types</a></h2>
<p>Define function signatures as types:</p>
<pre><code class="language-lua">type BinaryOp = (a: number, b: number) -&gt; number

const add: BinaryOp = (a, b) =&gt; a + b
const multiply: BinaryOp = (a, b) =&gt; a * b
</code></pre>
<p>With generics:</p>
<pre><code class="language-lua">type Mapper&lt;T, U&gt; = (value: T) -&gt; U

const toString: Mapper&lt;number, string&gt; = (n) =&gt; tostring(n)
</code></pre>
<h2 id="higher-order-functions"><a class="header" href="#higher-order-functions">Higher-Order Functions</a></h2>
<p>Functions that take or return functions:</p>
<pre><code class="language-lua">function map&lt;T, U&gt;(array: T[], fn: (value: T) -&gt; U): U[]
    const result: U[] = {}
    for i, value in ipairs(array) do
        result[i] = fn(value)
    end
    return result
end

const numbers: number[] = {1, 2, 3, 4}
const doubled: number[] = map(numbers, (x) =&gt; x * 2)  -- {2, 4, 6, 8}
</code></pre>
<h2 id="method-syntax"><a class="header" href="#method-syntax">Method Syntax</a></h2>
<p>Call methods with <code>:</code> (same as Lua):</p>
<pre><code class="language-lua">interface Counter {
    count: number,
    increment: (self: Counter) -&gt; void
}

const counter: Counter = {
    count = 0,
    increment = function(self)
        self.count = self.count + 1
    end
}

-- Method call syntax
counter:increment()

-- Equivalent to
counter.increment(counter)
</code></pre>
<h2 id="closures"><a class="header" href="#closures">Closures</a></h2>
<p>Functions can capture variables from outer scope:</p>
<pre><code class="language-lua">function makeCounter(): () -&gt; number
    local count: number = 0

    return function(): number
        count = count + 1
        return count
    end
end

const counter = makeCounter()
print(counter())  -- 1
print(counter())  -- 2
print(counter())  -- 3
</code></pre>
<h2 id="recursive-functions"><a class="header" href="#recursive-functions">Recursive Functions</a></h2>
<p>Functions can call themselves:</p>
<pre><code class="language-lua">function factorial(n: number): number
    if n &lt;= 1 then
        return 1
    end
    return n * factorial(n - 1)
end
</code></pre>
<p>Mutual recursion:</p>
<pre><code class="language-lua">function isEven(n: number): boolean
    if n == 0 then
        return true
    end
    return isOdd(n - 1)
end

function isOdd(n: number): boolean
    if n == 0 then
        return false
    end
    return isEven(n - 1)
end
</code></pre>
<h2 id="tail-call-optimization"><a class="header" href="#tail-call-optimization">Tail Call Optimization</a></h2>
<p>Lua optimizes tail calls. LuaNext preserves this:</p>
<pre><code class="language-lua">function factorial(n: number, acc: number = 1): number
    if n &lt;= 1 then
        return acc
    end
    return factorial(n - 1, n * acc)  -- Tail call
end
</code></pre>
<h2 id="function-overloading-type-only"><a class="header" href="#function-overloading-type-only">Function Overloading (Type-Only)</a></h2>
<p>Multiple signatures for documentation:</p>
<pre><code class="language-lua">-- Type declarations
declare function process(value: string): string
declare function process(value: number): number

-- Implementation
function process(value: string | number): string | number
    if type(value) == "string" then
        return value:upper()
    else
        return value * 2
    end
end
</code></pre>
<h2 id="throws-clause"><a class="header" href="#throws-clause">Throws Clause</a></h2>
<p>Document error types (informational):</p>
<pre><code class="language-lua">function readFile(path: string): string throws Error
    const file = io.open(path, "r")
    if not file then
        throw {message = "File not found"}
    end
    const content: string = file:read("*a")
    file:close()
    return content
end
</code></pre>
<p>The <code>throws</code> clause documents potential errors but doesn’t enforce them at compile time.</p>
<h2 id="variadic-return-types"><a class="header" href="#variadic-return-types">Variadic Return Types</a></h2>
<p>Functions with variable return values:</p>
<pre><code class="language-lua">function find&lt;T&gt;(array: T[], predicate: (value: T) -&gt; boolean): ...T | nil
    for i, value in ipairs(array) do
        if predicate(value) then
            return value, i  -- Returns T, number
        end
    end
    return nil
end
</code></pre>
<h2 id="anonymous-functions"><a class="header" href="#anonymous-functions">Anonymous Functions</a></h2>
<p>Functions without names:</p>
<pre><code class="language-lua">const numbers: number[] = {1, 2, 3, 4, 5}

const doubled = map(numbers, function(x: number): number
    return x * 2
end)
</code></pre>
<h2 id="immediately-invoked-function-expressions-iife"><a class="header" href="#immediately-invoked-function-expressions-iife">Immediately Invoked Function Expressions (IIFE)</a></h2>
<pre><code class="language-lua">const result: number = (function(): number
    const temp: number = calculate()
    return temp * 2
end)()
</code></pre>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<ul>
<li><a href="type-system.html">Type System</a> — Generics, unions, advanced types</li>
<li><a href="classes.html">Classes</a> — Methods and constructors</li>
<li><a href="error-handling.html">Error Handling</a> — Try-catch and error types</li>
</ul>
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><a href="basics.html">Basics</a> — Variable declarations</li>
<li><a href="advanced-types.html">Advanced Types</a> — Function type utilities</li>
<li><a href="operators.html">Operators</a> — Function call operators</li>
</ul>

                </section>

                </div><!-- page-inner -->

            </div><!-- page-wrapper -->

            </div><!-- book-inner -->

            <!-- Version Selector -->
            <nav class="nav-wide-wrapper" aria-label="More">
                <a href="javascript:void(0)" id="menu-bar-wide" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                    <i class="fa fa-bars"></i>
                </a>
            </nav>

            <!-- Version selector dropdown -->
            <div id="version-selector" class="version-selector">
                <select id="version-picker" onchange="switchVersion(this.value)" aria-label="Documentation version">
                    <option value="latest">Latest</option>
                </select>
            </div>

        </div><!-- book -->

        <!-- Custom scripts -->
        <script>
            // Version selector functionality
            function switchVersion(version) {
                const base = window.location.origin + '/luanext/';
                if (version === 'latest') {
                    window.location.href = base;
                } else {
                    window.location.href = base + version + '/';
                }
            }

            // Load versions.json and populate selector if it exists
            fetch('/luanext/versions.json')
                .then(response => response.json())
                .then(data => {
                    if (data.versions && data.versions.length > 1) {
                        const selector = document.getElementById('version-picker');
                        data.versions.forEach(v => {
                            if (v.version !== 'latest') {
                                const option = document.createElement('option');
                                option.value = 'v' + v.version;
                                option.textContent = 'v' + v.version;
                                selector.appendChild(option);
                            }
                        });
                    }
                })
                .catch(() => {
                    // versions.json not found (expected during initial setup)
                    // Selector will only show "Latest"
                });
        </script>

        <!-- mdBook scripts and content scripts -->
        <script src="js/clipboard.min.js" type="text/javascript"></script>
        <script src="js/highlight.js" type="text/javascript"></script>
        <script src="js/book.js" type="text/javascript"></script>

        <!-- Custom theme script -->
        <script src="js/custom-theme.js" type="text/javascript"></script>

        <script src="js/elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/lunr-en.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/search.js" type="text/javascript" charset="utf-8"></script>

    </body>
</html>
