<!DOCTYPE html>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Fallback to default mdbook template -->
        
        <meta name="robots" content="noindex,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta charset="utf-8">
        <title>Control Flow - LuaNext Documentation</title>
        <script>
            var theme = localStorage.getItem("mdbook-theme");
            if (theme === null || theme === undefined) { theme = "light"; }
            var html = document.querySelector("html");
            html.classList.remove("light");
            html.classList.add(theme);
        </script>
        <meta name="description" content="A typed superset of Lua with gradual typing, inspired by TypeScript">
        <link rel="icon" href="favicon.svg">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/custom.css">
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">

    </head>
    <body>
        <!-- Provide the book title to JavaScript -->
        <script>
            window.book = window.book || {};
            window.book.language = "en";
        </script>

        <div id="book" class="book">
            <div class="book-inner">

            <nav role="navigation" aria-label="Table of contents" class="sidebar">
                <ol class="chapter"><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="introduction.html">Introduction</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Language</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/basics.html"><strong aria-hidden="true">1.</strong> Basics</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/control-flow.html"><strong aria-hidden="true">2.</strong> Control Flow</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/functions.html"><strong aria-hidden="true">3.</strong> Functions</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/type-system.html"><strong aria-hidden="true">4.</strong> Type System</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/classes.html"><strong aria-hidden="true">5.</strong> Classes</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/interfaces.html"><strong aria-hidden="true">6.</strong> Interfaces</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/enums.html"><strong aria-hidden="true">7.</strong> Enums</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/modules.html"><strong aria-hidden="true">8.</strong> Modules</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/error-handling.html"><strong aria-hidden="true">9.</strong> Error Handling</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/pattern-matching.html"><strong aria-hidden="true">10.</strong> Pattern Matching</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/decorators.html"><strong aria-hidden="true">11.</strong> Decorators</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/advanced-types.html"><strong aria-hidden="true">12.</strong> Advanced Types</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="language/operators.html"><strong aria-hidden="true">13.</strong> Operators</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Guides</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="guides/migrating-from-lua.html"><strong aria-hidden="true">14.</strong> Migrating from Lua</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="guides/lua-targets.html"><strong aria-hidden="true">15.</strong> Lua Targets</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Reference</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/cli.html"><strong aria-hidden="true">16.</strong> CLI</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/configuration.html"><strong aria-hidden="true">17.</strong> Configuration</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/standard-library.html"><strong aria-hidden="true">18.</strong> Standard Library</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/utility-types.html"><strong aria-hidden="true">19.</strong> Utility Types</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/reflection.html"><strong aria-hidden="true">20.</strong> Reflection API</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/error-codes.html"><strong aria-hidden="true">21.</strong> Error Codes</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/grammar.html"><strong aria-hidden="true">22.</strong> Grammar</a></span></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="reference/keywords.html"><strong aria-hidden="true">23.</strong> Keywords</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">Contributing</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="contributing/setup.html"><strong aria-hidden="true">24.</strong> Getting Started</a></span></li><li class="chapter-item expanded "><li class="spacer"></li></li><li class="chapter-item expanded "><li class="part-title">API Reference</li></li><li class="chapter-item expanded "><span class="chapter-link-wrapper"><a href="api/index.html"><strong aria-hidden="true">25.</strong> Rust API Docs</a></span></li></ol>
            </nav>

            <div id="page-wrapper" class="page-wrapper">

                <div class="page-inner">

                <section class="normal" id="main">
                    <h1 id="control-flow"><a class="header" href="#control-flow">Control Flow</a></h1>
<p>LuaNext supports all Lua control flow constructs plus additional features like <code>continue</code>.</p>
<h2 id="if-statements"><a class="header" href="#if-statements">If Statements</a></h2>
<h3 id="basic-if"><a class="header" href="#basic-if">Basic If</a></h3>
<pre><code class="language-lua">const age: number = 25

if age &gt;= 18 then
    print("Adult")
end
</code></pre>
<h3 id="if-else"><a class="header" href="#if-else">If-Else</a></h3>
<pre><code class="language-lua">const score: number = 85

if score &gt;= 90 then
    print("A")
else
    print("B or lower")
end
</code></pre>
<h3 id="if-elseif-else"><a class="header" href="#if-elseif-else">If-Elseif-Else</a></h3>
<pre><code class="language-lua">const score: number = 85

if score &gt;= 90 then
    print("A")
elseif score &gt;= 80 then
    print("B")
elseif score &gt;= 70 then
    print("C")
else
    print("F")
end
</code></pre>
<h3 id="type-narrowing"><a class="header" href="#type-narrowing">Type Narrowing</a></h3>
<p>LuaNext narrows types within conditional branches:</p>
<pre><code class="language-lua">const value: string | number = getValue()

if type(value) == "string" then
    -- value is string here
    print(value:upper())
elseif type(value) == "number" then
    -- value is number here
    print(value * 2)
end
</code></pre>
<h2 id="while-loops"><a class="header" href="#while-loops">While Loops</a></h2>
<p>Execute block while condition is true:</p>
<pre><code class="language-lua">local count: number = 0

while count &lt; 5 do
    print(count)
    count = count + 1
end
</code></pre>
<h2 id="repeat-until-loops"><a class="header" href="#repeat-until-loops">Repeat-Until Loops</a></h2>
<p>Execute block at least once, until condition becomes true:</p>
<pre><code class="language-lua">local count: number = 0

repeat
    print(count)
    count = count + 1
until count &gt;= 5
</code></pre>
<h2 id="for-loops"><a class="header" href="#for-loops">For Loops</a></h2>
<h3 id="numeric-for"><a class="header" href="#numeric-for">Numeric For</a></h3>
<pre><code class="language-lua">-- for var = start, end, step do
for i = 1, 10, 1 do
    print(i)
end

-- step defaults to 1
for i = 1, 10 do
    print(i)
end

-- Counting down
for i = 10, 1, -1 do
    print(i)
end
</code></pre>
<p>Type annotation on loop variable:</p>
<pre><code class="language-lua">for i: integer = 1, 100 do
    print(i)
end
</code></pre>
<h3 id="generic-for"><a class="header" href="#generic-for">Generic For</a></h3>
<p>Iterate over tables, arrays, iterators:</p>
<pre><code class="language-lua">-- Arrays
const numbers: number[] = {10, 20, 30, 40}

for i, value in ipairs(numbers) do
    print(i, value)
end

-- Tables
const user = {name = "Alice", age = 30}

for key, value in pairs(user) do
    print(key, value)
end

-- Custom iterators
for line in io.lines("file.txt") do
    print(line)
end
</code></pre>
<p>Type annotations:</p>
<pre><code class="language-lua">for i: integer, value: number in ipairs(numbers) do
    print(i, value)
end
</code></pre>
<h2 id="break"><a class="header" href="#break">Break</a></h2>
<p>Exit loop early:</p>
<pre><code class="language-lua">for i = 1, 100 do
    if i == 50 then
        break
    end
    print(i)
end
</code></pre>
<h2 id="continue"><a class="header" href="#continue">Continue</a></h2>
<p>Skip to next iteration (LuaNext extension):</p>
<pre><code class="language-lua">for i = 1, 10 do
    if i % 2 == 0 then
        continue  -- Skip even numbers
    end
    print(i)  -- Only prints odd numbers
end
</code></pre>
<p>Compiles to a <code>goto</code> statement:</p>
<pre><code class="language-lua">for i = 1, 10 do
    if i % 2 == 0 then
        goto continue_1
    end
    print(i)
    ::continue_1::
end
</code></pre>
<h2 id="labels-and-goto"><a class="header" href="#labels-and-goto">Labels and Goto</a></h2>
<p>Jump to labeled positions:</p>
<pre><code class="language-lua">local i: number = 0

::start::
print(i)
i = i + 1

if i &lt; 5 then
    goto start
end

print("Done")
</code></pre>
<p><strong>Restrictions:</strong></p>
<ul>
<li>Cannot jump into a block from outside</li>
<li>Cannot jump out of a function</li>
<li>Labels must be defined in the same scope</li>
</ul>
<h2 id="do-blocks"><a class="header" href="#do-blocks">Do Blocks</a></h2>
<p>Create scoped blocks:</p>
<pre><code class="language-lua">do
    const x: number = 10
    print(x)
end

-- x is not in scope here
</code></pre>
<p>Useful for limiting variable scope:</p>
<pre><code class="language-lua">local result: number = 0

do
    const temp: number = calculate()
    const adjusted: number = temp * 2
    result = adjusted
end

-- temp and adjusted are not in scope
print(result)
</code></pre>
<h2 id="ternary-operator"><a class="header" href="#ternary-operator">Ternary Operator</a></h2>
<p>Concise conditional expressions:</p>
<pre><code class="language-lua">const age: number = 20
const status: string = age &gt;= 18 ? "adult" : "minor"
</code></pre>
<p>Compiles to:</p>
<pre><code class="language-lua">local age = 20
local status = (age &gt;= 18) and "adult" or "minor"
</code></pre>
<p><strong>Note:</strong> Beware of falsy values. Use full <code>if</code> statement when middle value could be <code>false</code> or <code>nil</code>.</p>
<h2 id="short-circuit-evaluation"><a class="header" href="#short-circuit-evaluation">Short-Circuit Evaluation</a></h2>
<h3 id="and-and"><a class="header" href="#and-and">And (<code>and</code>)</a></h3>
<p>Returns first falsy value or last value:</p>
<pre><code class="language-lua">const a: boolean = true
const b: boolean = false

const result = a and b  -- false
</code></pre>
<h3 id="or-or"><a class="header" href="#or-or">Or (<code>or</code>)</a></h3>
<p>Returns first truthy value or last value:</p>
<pre><code class="language-lua">const name: string | nil = getName()
const displayName: string = name or "Guest"
</code></pre>
<h2 id="null-coalescing-operator"><a class="header" href="#null-coalescing-operator">Null Coalescing Operator</a></h2>
<p>Returns right-hand side if left is <code>nil</code> (unlike <code>or</code>, which checks for all falsy values):</p>
<pre><code class="language-lua">const value: number | nil = 0
const result: number = value ?? 10  -- 0 (not 10, because 0 is not nil)

const none: number | nil = nil
const fallback: number = none ?? 10  -- 10
</code></pre>
<p>Compiles to:</p>
<pre><code class="language-lua">local value = 0
local result = (value ~= nil) and value or 10

local none = nil
local fallback = (none ~= nil) and none or 10
</code></pre>
<h2 id="optional-chaining"><a class="header" href="#optional-chaining">Optional Chaining</a></h2>
<p>Safely access nested properties that might be nil:</p>
<pre><code class="language-lua">interface User {
    profile?: {
        address?: {
            city?: string
        }
    }
}

const user: User = getUser()

-- Safe access with optional chaining
const city: string | nil = user.profile?.address?.city

-- Without optional chaining (verbose)
local city: string | nil = nil
if user.profile ~= nil and user.profile.address ~= nil then
    city = user.profile.address.city
end
</code></pre>
<p>Method calls:</p>
<pre><code class="language-lua">const result: any = obj?.method?.(arg1, arg2)
</code></pre>
<h2 id="pattern-matching"><a class="header" href="#pattern-matching">Pattern Matching</a></h2>
<p>Match expressions for complex conditionals (see <a href="pattern-matching.html">Pattern Matching</a> for details):</p>
<pre><code class="language-lua">type Result = {ok: true, value: number} | {ok: false, error: string}

const result: Result = processData()

match result {
    {ok: true, value} =&gt; print("Success:", value),
    {ok: false, error} =&gt; print("Error:", error)
}
</code></pre>
<h2 id="type-guards"><a class="header" href="#type-guards">Type Guards</a></h2>
<p>Functions that narrow types:</p>
<pre><code class="language-lua">function isString(value: unknown): value is string
    return type(value) == "string"
end

const data: unknown = getData()

if isString(data) then
    -- data is string here
    print(data:upper())
end
</code></pre>
<h2 id="exhaustiveness-checking"><a class="header" href="#exhaustiveness-checking">Exhaustiveness Checking</a></h2>
<p>Ensure all cases are handled:</p>
<pre><code class="language-lua">type Status = "active" | "inactive" | "pending"

function handleStatus(status: Status): void
    if status == "active" then
        print("Active")
    elseif status == "inactive" then
        print("Inactive")
    elseif status == "pending" then
        print("Pending")
    else
        -- Exhaustive check: status is never here
        const _exhaustive: never = status
    end
end
</code></pre>
<p>If you add a new status value and forget to handle it, the compiler will catch the error.</p>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<ul>
<li><a href="functions.html">Functions</a> — Function declarations and types</li>
<li><a href="pattern-matching.html">Pattern Matching</a> — Advanced pattern matching</li>
<li><a href="type-system.html">Type System</a> — Type narrowing and guards</li>
</ul>
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><a href="operators.html">Operators</a> — Complete operator reference</li>
<li><a href="basics.html">Basics</a> — Variable declarations and types</li>
</ul>

                </section>

                </div><!-- page-inner -->

            </div><!-- page-wrapper -->

            </div><!-- book-inner -->

            <!-- Version Selector -->
            <nav class="nav-wide-wrapper" aria-label="More">
                <a href="javascript:void(0)" id="menu-bar-wide" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                    <i class="fa fa-bars"></i>
                </a>
            </nav>

            <!-- Version selector dropdown -->
            <div id="version-selector" class="version-selector">
                <select id="version-picker" onchange="switchVersion(this.value)" aria-label="Documentation version">
                    <option value="latest">Latest</option>
                </select>
            </div>

        </div><!-- book -->

        <!-- Custom scripts -->
        <script>
            // Version selector functionality
            function switchVersion(version) {
                const base = window.location.origin + '/luanext/';
                if (version === 'latest') {
                    window.location.href = base;
                } else {
                    window.location.href = base + version + '/';
                }
            }

            // Load versions.json and populate selector if it exists
            fetch('/luanext/versions.json')
                .then(response => response.json())
                .then(data => {
                    if (data.versions && data.versions.length > 1) {
                        const selector = document.getElementById('version-picker');
                        data.versions.forEach(v => {
                            if (v.version !== 'latest') {
                                const option = document.createElement('option');
                                option.value = 'v' + v.version;
                                option.textContent = 'v' + v.version;
                                selector.appendChild(option);
                            }
                        });
                    }
                })
                .catch(() => {
                    // versions.json not found (expected during initial setup)
                    // Selector will only show "Latest"
                });
        </script>

        <!-- mdBook scripts and content scripts -->
        <script src="js/clipboard.min.js" type="text/javascript"></script>
        <script src="js/highlight.js" type="text/javascript"></script>
        <script src="js/book.js" type="text/javascript"></script>

        <!-- Custom theme script -->
        <script src="js/custom-theme.js" type="text/javascript"></script>

        <script src="js/elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/lunr-en.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/search.js" type="text/javascript" charset="utf-8"></script>

    </body>
</html>
